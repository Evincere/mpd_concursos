<div class="concursos-feature-container">
  <div class="main-content" [class.blur-effect]="concursoSeleccionado">
    <app-search-header
      title="Concursos"
      icon="briefcase"
      placeholder="Buscar concursos..."
      (search)="onSearch($event)"
      (filter)="onFilter()"
      [filtrosActivos]="filtrosActivos">
    </app-search-header>

    <div class="concursos-content">
      <app-loader 
        *ngIf="loading"
        [overlay]="true"
        message="Cargando concursos...">
      </app-loader>

      <div class="error-message" *ngIf="error">
        <i class="fas fa-exclamation-circle"></i>
        <div class="error-content">
          <h4>Error al cargar los concursos</h4>
          <p>{{ error.status === 0 ? 'No se pudo conectar con el servidor' : error.error?.message || 'Ocurrió un error inesperado' }}</p>
        </div>
        <button mat-button (click)="retryLoad()">
          <i class="fas fa-redo"></i>
          Reintentar
        </button>
      </div>

      <div class="concursos-list" *ngIf="!loading && !error && concursos.length > 0">
        <div class="concurso-item" *ngFor="let concurso of concursos" (click)="verDetalle(concurso)">
          <div class="card-header">
            <div class="estado" [ngClass]="concurso.status">
              {{ getEstadoConcursoLabel(concurso.status) }}
            </div>
            <div class="fecha">
              <i class="fas fa-calendar-alt"></i>
              {{ concurso.startDate | date:'dd/MM/yyyy' }} - {{ concurso.endDate | date:'dd/MM/yyyy' }}
            </div>
          </div>

          <div class="card-content">
            <h3>{{ concurso.title }}</h3>
            <p class="cargo">{{ concurso.position }}</p>
            <p class="dependencia">{{ concurso.dependencia }}</p>
          </div>

          <div class="card-actions">
            <button mat-stroked-button 
                    class="details-button" 
                    (click)="verDetalle(concurso)">
              <mat-icon class="details-icon">visibility</mat-icon>
              <span>Ver Detalles</span>
            </button>
          </div>
        </div>
      </div>

      <div class="no-results" *ngIf="!loading && !error && concursos.length === 0">
        <i class="fas fa-search"></i>
        <h4>No se encontraron concursos</h4>
        <p>Intenta con otros términos de búsqueda</p>
      </div>

      <app-filtros-panel 
        *ngIf="mostrarFiltros"
        (filtrosChange)="aplicarFiltros($event)"
        (cerrar)="toggleFiltros()">
      </app-filtros-panel>
      
      <div class="backdrop" 
        *ngIf="mostrarFiltros"
        (click)="toggleFiltros()"
        [@fadeInOut]="mostrarFiltros">
      </div>
    </div>
  </div>

  <div class="overlay" *ngIf="concursoSeleccionado" [@fadeInOut]></div>
  <app-concurso-detalle 
    *ngIf="concursoSeleccionado"
    [concurso]="concursoSeleccionado"
    (cerrarDetalle)="cerrarDetalle()"
    (inscripcionRealizada)="onInscriptionComplete($event)">
  </app-concurso-detalle>
</div>
