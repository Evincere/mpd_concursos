<div class="perfil-container">
    <header class="perfil-header">
        <h2>
            <i class="fas fa-user-circle"></i>
            Mi Perfil
        </h2>
    </header>

    <mat-tab-group class="perfil-tabs">
        <!-- Tab Información Personal -->
        <mat-tab label="Información Personal">
            <div class="tab-content">
                <div class="perfil-foto">
                    <div class="foto-container">
                        <ng-container
                            *ngIf="fotoPerfil && fotoPerfil !== 'assets/images/default-avatar.png'; else defaultAvatar">
                            <img [src]="fotoPerfil" alt="Foto de perfil">
                        </ng-container>
                        <ng-template #defaultAvatar>
                            <div class="default-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                        </ng-template>
                        <button mat-mini-fab class="cambiar-foto-btn" (click)="abrirSelectorArchivo()">
                            <i class="fas fa-camera"></i>
                        </button>
                        <input type="file" hidden #fileInput (change)="onFileSelected($event)" accept="image/*">
                    </div>
                </div>

                <form [formGroup]="perfilForm" class="perfil-form">
                    <!-- Sección de Datos Personales -->
                    <div class="form-section personal-data">
                        <div class="section-header">
                            <div class="header-content">
                                <i class="fas fa-user-circle"></i>
                                <h3>Datos Personales</h3>
                            </div>
                            <button mat-icon-button
                                    [color]="isEditing ? 'warn' : 'primary'"
                                    (click)="isEditing ? resetForm() : toggleEditing()"
                                    class="edit-button">
                                <i class="fas" [ngClass]="isEditing ? 'fa-times' : 'fa-edit'"></i>
                            </button>
                        </div>

                        <div class="form-content" [class.editing]="isEditing">
                            <div class="form-row">
                                <div class="form-field">
                                    <label>Nombre de Usuario</label>
                                    <div class="field-content">
                                        <span class="field-value">{{perfilForm.get('username')?.value}}</span>
                                        <mat-form-field *ngIf="isEditing" appearance="outline">
                                            <input matInput formControlName="username" readonly>
                                            <mat-hint>
                                                <i class="fas fa-info-circle"></i>
                                                Campo no modificable
                                            </mat-hint>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="form-field">
                                    <label>Email</label>
                                    <div class="field-content">
                                        <span class="field-value">{{perfilForm.get('email')?.value}}</span>
                                        <mat-form-field *ngIf="isEditing" appearance="outline">
                                            <input matInput formControlName="email" readonly>
                                            <mat-hint>
                                                <i class="fas fa-info-circle"></i>
                                                Campo no modificable
                                            </mat-hint>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-field">
                                    <label>Nombre</label>
                                    <div class="field-content">
                                        <span class="field-value" *ngIf="!isEditing">{{perfilForm.get('firstName')?.value}}</span>
                                        <mat-form-field *ngIf="isEditing" appearance="outline">
                                            <input matInput formControlName="firstName" required>
                                            <mat-error *ngIf="perfilForm.get('firstName')?.hasError('required')">
                                                El nombre es requerido
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="form-field">
                                    <label>Apellido</label>
                                    <div class="field-content">
                                        <span class="field-value" *ngIf="!isEditing">{{perfilForm.get('lastName')?.value}}</span>
                                        <mat-form-field *ngIf="isEditing" appearance="outline">
                                            <input matInput formControlName="lastName" required>
                                            <mat-error *ngIf="perfilForm.get('lastName')?.hasError('required')">
                                                El apellido es requerido
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-field">
                                    <label>DNI</label>
                                    <div class="field-content">
                                        <span class="field-value" *ngIf="!isEditing">{{perfilForm.get('dni')?.value}}</span>
                                        <mat-form-field *ngIf="isEditing" appearance="outline">
                                            <input matInput formControlName="dni" required maxlength="8" pattern="^[0-9]{8}$">
                                            <mat-error *ngIf="perfilForm.get('dni')?.hasError('pattern')">
                                                <i class="fas fa-exclamation-circle"></i>
                                                El DNI debe contener 8 dígitos numéricos
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="form-field">
                                    <label>CUIT</label>
                                    <div class="field-content">
                                        <span class="field-value" *ngIf="!isEditing">{{perfilForm.get('cuit')?.value}}</span>
                                        <mat-form-field *ngIf="isEditing" appearance="outline">
                                            <input matInput
                                                formControlName="cuit"
                                                required
                                                (blur)="onCuitBlur()"
                                                placeholder="XX-XXXXXXXX-X"
                                                maxlength="13">
                                            <mat-error *ngIf="perfilForm.get('cuit')?.hasError('pattern')">
                                                <i class="fas fa-exclamation-circle"></i>
                                                El formato debe ser XX-XXXXXXXX-X
                                            </mat-error>
                                            <mat-hint>
                                                <i class="fas fa-info-circle"></i>
                                                Ingrese solo números, el formato se aplicará automáticamente
                                            </mat-hint>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sección de Información de Contacto -->
                    <div class="form-section contact-info">
                        <div class="section-header">
                            <div class="header-content">
                                <i class="fas fa-address-book"></i>
                                <h3>Información de Contacto</h3>
                            </div>
                        </div>

                        <div class="form-content" [class.editing]="isEditing">
                            <div class="form-row">
                                <div class="form-field">
                                    <label>Teléfono</label>
                                    <div class="field-content">
                                        <span class="field-value" *ngIf="!isEditing">{{perfilForm.get('telefono')?.value || 'No especificado'}}</span>
                                        <mat-form-field *ngIf="isEditing" appearance="outline">
                                            <input matInput
                                                formControlName="telefono"
                                                placeholder="Ingrese su teléfono">
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="form-field">
                                    <label>Dirección</label>
                                    <div class="field-content">
                                        <span class="field-value" *ngIf="!isEditing">{{perfilForm.get('direccion')?.value || 'No especificada'}}</span>
                                        <mat-form-field *ngIf="isEditing" appearance="outline">
                                            <input matInput
                                                formControlName="direccion"
                                                placeholder="Ingrese su dirección">
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Botón de Guardar -->
                    <div class="form-actions" *ngIf="isEditing">
                        <button mat-flat-button
                                color="primary"
                                (click)="guardarPerfil()"
                                [disabled]="!perfilForm.valid || !perfilForm.dirty"
                                class="save-button">
                            <i class="fas fa-save"></i>
                            Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
        </mat-tab>

        <!-- Tab Curriculum Vitae -->
        <mat-tab label="Curriculum Vitae">
            <div class="curriculum-container">
                <!-- Barra lateral con botones de acción -->
                <aside class="curriculum-sidebar">
                    <div class="action-group">
                        <h3>Experiencia Laboral</h3>
                        <button mat-flat-button color="primary" (click)="agregarExperiencia()">
                            <i class="fas fa-plus"></i>
                            Agregar Experiencia
                        </button>
                    </div>

                    <div class="action-group">
                        <h3>Educación</h3>
                        <button mat-flat-button color="primary" (click)="agregarEducacion()" [disabled]="isLoading">
                            <i class="fas fa-plus"></i>
                            Agregar Educación
                        </button>
                    </div>
                    
                    <!-- Indicador de carga -->
                    <div *ngIf="isLoading" class="text-center my-3">
                        <mat-spinner diameter="40" style="margin: 0 auto;"></mat-spinner>
                        <span>Procesando...</span>
                    </div>
                </aside>

                <!-- Contenido principal del currículum -->
                <main class="curriculum-content" [formGroup]="perfilForm">
                    <!-- Sección de Experiencia Laboral -->
                    <section class="cv-section">
                        <div class="section-header">
                            <i class="fas fa-briefcase"></i>
                            <h2>Experiencia Laboral</h2>
                        </div>

                        <div class="cv-items" formArrayName="experiencias">
                            <div class="cv-item" *ngFor="let exp of experiencias.controls; let i = index"
                                [formGroupName]="i">
                                <div class="item-main">
                                    <div class="form-field">
                                        <label class="field-label" for="cargo">Cargo o Puesto</label>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Cargo o Puesto</mat-label>
                                            <input matInput
                                                id="cargo"
                                                formControlName="cargo"
                                                placeholder="Ej: Abogado Senior">
                                            <mat-error *ngIf="exp.get('cargo')?.errors?.['required']">
                                                Este campo es requerido
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <div class="form-field">
                                        <label class="field-label" for="empresa">Empresa u Organización</label>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Empresa u Organización</mat-label>
                                            <input matInput
                                                id="empresa"
                                                formControlName="empresa"
                                                placeholder="Ej: Ministerio Público de la Defensa">
                                            <mat-error *ngIf="exp.get('empresa')?.errors?.['required']">
                                                Este campo es requerido
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-field-container">
                                            <label for="fechaInicio" class="form-label">Fecha de Inicio</label>
                                            <mat-form-field appearance="outline">
                                                <mat-label>Fecha de Inicio</mat-label>
                                                <input matInput
                                                    [matDatepicker]="fechaInicioPicker"
                                                    formControlName="fechaInicio"
                                                    placeholder="DD/MM/AAAA">
                                                <mat-datepicker-toggle matSuffix [for]="fechaInicioPicker"></mat-datepicker-toggle>
                                                <mat-datepicker #fechaInicioPicker></mat-datepicker>
                                            </mat-form-field>
                                        </div>

                                        <div class="form-field-container">
                                            <label for="fechaFin" class="form-label">Fecha de Fin</label>
                                            <mat-form-field appearance="outline">
                                                <mat-label>Fecha de Fin</mat-label>
                                                <input matInput
                                                    [matDatepicker]="fechaFinPicker"
                                                    formControlName="fechaFin"
                                                    placeholder="DD/MM/AAAA">
                                                <mat-datepicker-toggle matSuffix [for]="fechaFinPicker"></mat-datepicker-toggle>
                                                <mat-datepicker #fechaFinPicker></mat-datepicker>
                                            </mat-form-field>
                                        </div>
                                    </div>

                                    <div class="form-field">
                                        <label class="field-label" for="descripcion">Descripción de responsabilidades y logros</label>
                                        <mat-form-field appearance="outline" class="description-field">
                                            <mat-label>Descripción de responsabilidades y logros</mat-label>
                                            <textarea matInput
                                                id="descripcion"
                                                formControlName="descripcion"
                                                rows="3"
                                                placeholder="Describe tus principales responsabilidades y logros en este puesto">
                                            </textarea>
                                            <mat-error *ngIf="exp.get('descripcion')?.errors?.['required']">
                                                Este campo es requerido
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <!-- Nuevo campo: Comentarios sobre el puesto -->
                                    <div class="form-field">
                                        <label class="field-label" for="comentario">Comentarios sobre el puesto de trabajo</label>
                                        <mat-form-field appearance="outline" class="description-field">
                                            <mat-label>Comentarios sobre el puesto de trabajo</mat-label>
                                            <textarea matInput
                                                id="comentario"
                                                formControlName="comentario"
                                                rows="2"
                                                placeholder="Información adicional relevante sobre este puesto">
                                            </textarea>
                                        </mat-form-field>
                                    </div>

                                    <!-- Nuevo campo: Probanza o certificado -->
                                    <div class="form-field certificado-field">
                                        <label class="certificado-label">Probanza o certificado (PDF)</label>
                                        <div class="certificado-container">
                                            <ng-container *ngIf="exp.get('certificadoId')?.value; else noCertificado">
                                                <div class="certificado-preview">
                                                    <span class="certificado-nombre">Certificado cargado</span>
                                                    <div class="certificado-actions">
                                                        <button mat-icon-button color="primary" type="button"
                                                                matTooltip="Ver certificado"
                                                                (click)="verCertificado(exp.get('certificadoId')?.value)">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <button mat-icon-button color="warn" type="button"
                                                                matTooltip="Eliminar certificado"
                                                                (click)="eliminarCertificado(i)">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-template #noCertificado>
                                                <button mat-stroked-button color="primary" type="button"
                                                        (click)="cargarCertificado(i)">
                                                    <i class="fas fa-upload"></i>
                                                    Subir certificado
                                                </button>
                                                <span class="certificado-hint">
                                                    Sube un certificado o probanza en formato PDF que acredite esta experiencia laboral
                                                </span>
                                            </ng-template>
                                        </div>
                                    </div>
                                </div>

                                <div class="item-actions">
                                    <button mat-icon-button
                                        type="button"
                                        class="delete-button"
                                        (click)="eliminarExperiencia(i)"
                                        [attr.aria-label]="'Eliminar experiencia'">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>


                    <!-- Sección de Educación -->
                    <section class="cv-section">
                        <div class="section-header">
                            <i class="fas fa-graduation-cap"></i>
                            <h2>Educación</h2>
                        </div>

                        <div class="cv-items" formArrayName="educacion">
                            <div class="cv-item" *ngFor="let edu of educacion.controls; let i = index"
                                [formGroupName]="i">
                                <div class="item-main">
                                    <!-- Campos esenciales siempre visibles -->
                                    <div class="form-field">
                                        <label class="field-label" for="titulo">Título</label>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Título</mat-label>
                                            <input matInput
                                                id="titulo"
                                                formControlName="titulo"
                                                placeholder="Ej: Abogado">
                                            <mat-error *ngIf="edu.get('titulo')?.errors?.['required']">
                                                Este campo es requerido
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <div class="form-field">
                                        <label class="field-label" for="institucion">Institución Educativa</label>
                                        <mat-form-field appearance="outline">
                                            <mat-label>Institución Educativa</mat-label>
                                            <input matInput
                                                id="institucion"
                                                formControlName="institucion"
                                                placeholder="Ej: Universidad Nacional de Cuyo">
                                            <mat-error *ngIf="edu.get('institucion')?.errors?.['required']">
                                                Este campo es requerido
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <!-- Grupo 1: Carga de fechas -->
                                    <div *ngIf="!edu.get('grupo1Cargado') && !isLoading" class="text-center my-3">
                                        <button mat-button color="primary" (click)="cargarCamposAdicionales(i, 1)">
                                            <i class="fas fa-calendar-alt"></i> Agregar fechas
                                        </button>
                                    </div>

                                    <!-- Campos del Grupo 1 (Fechas) -->
                                    <ng-container *ngIf="edu.get('grupo1Cargado')">
                                        <div class="form-row">
                                            <div class="form-field-container">
                                                <label for="fechaInicio" class="form-label">Fecha de Inicio</label>
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Fecha de Inicio</mat-label>
                                                    <input matInput
                                                        [matDatepicker]="fechaEduInicioPicker"
                                                        formControlName="fechaInicio"
                                                        placeholder="DD/MM/AAAA">
                                                    <mat-datepicker-toggle matSuffix [for]="fechaEduInicioPicker"></mat-datepicker-toggle>
                                                    <mat-datepicker #fechaEduInicioPicker></mat-datepicker>
                                                </mat-form-field>
                                            </div>

                                            <div class="form-field-container">
                                                <label for="fechaFin" class="form-label">Fecha de Fin</label>
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Fecha de Fin</mat-label>
                                                    <input matInput
                                                        [matDatepicker]="fechaEduFinPicker"
                                                        formControlName="fechaFin"
                                                        placeholder="DD/MM/AAAA">
                                                    <mat-datepicker-toggle matSuffix [for]="fechaEduFinPicker"></mat-datepicker-toggle>
                                                    <mat-datepicker #fechaEduFinPicker></mat-datepicker>
                                                </mat-form-field>
                                            </div>
                                        </div>

                                        <div class="form-field">
                                            <label class="field-label" for="tipo">Tipo de Educación</label>
                                            <mat-form-field appearance="outline">
                                                <mat-label>Tipo de Educación</mat-label>
                                                <mat-select formControlName="tipo">
                                                    <mat-option *ngFor="let tipo of tiposEducacion" [value]="tipo">
                                                        {{tipo}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>

                                        <div class="form-field">
                                            <label class="field-label" for="estado">Estado</label>
                                            <mat-form-field appearance="outline">
                                                <mat-label>Estado</mat-label>
                                                <mat-select formControlName="estado">
                                                    <mat-option *ngFor="let estado of estadosEducacion" [value]="estado">
                                                        {{estado}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>

                                        <!-- Grupo 2: Botón para cargar detalles académicos -->
                                        <div *ngIf="!edu.get('grupo2Cargado') && !isLoading" class="text-center my-3">
                                            <button mat-button color="primary" (click)="cargarCamposAdicionales(i, 2)">
                                                <i class="fas fa-graduation-cap"></i> Agregar detalles académicos
                                            </button>
                                        </div>
                                    </ng-container>

                                    <!-- Campos del Grupo 2 (Detalles académicos) -->
                                    <ng-container *ngIf="edu.get('grupo2Cargado')">
                                        <div class="form-row">
                                            <div class="form-field-container">
                                                <label for="duracionAnios" class="form-label">Duración (años)</label>
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Duración</mat-label>
                                                    <input matInput
                                                        type="number"
                                                        formControlName="duracionAnios"
                                                        placeholder="Ej: 5">
                                                    <mat-error *ngIf="edu.get('duracionAnios')?.errors?.['min']">
                                                        La duración debe ser mayor a 0
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div class="form-field-container">
                                                <label for="promedio" class="form-label">Promedio</label>
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Promedio</mat-label>
                                                    <input matInput
                                                        type="number"
                                                        formControlName="promedio"
                                                        placeholder="Ej: 8.5">
                                                    <mat-error *ngIf="edu.get('promedio')?.errors?.['min'] || edu.get('promedio')?.errors?.['max']">
                                                        El promedio debe estar entre 0 y 10
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-field-container">
                                                <label for="cargaHoraria" class="form-label">Carga Horaria</label>
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Carga Horaria</mat-label>
                                                    <input matInput
                                                        type="number"
                                                        formControlName="cargaHoraria"
                                                        placeholder="Ej: 120">
                                                    <mat-error *ngIf="edu.get('cargaHoraria')?.errors?.['min']">
                                                        La carga horaria debe ser mayor a 0
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div class="form-field-container">
                                                <label for="evaluacionFinal" class="form-label">¿Tuvo evaluación final?</label>
                                                <mat-radio-group formControlName="evaluacionFinal" class="radio-group">
                                                    <mat-radio-button [value]="true">Sí</mat-radio-button>
                                                    <mat-radio-button [value]="false">No</mat-radio-button>
                                                </mat-radio-group>
                                            </div>
                                        </div>

                                        <!-- Grupo 3: Botón para cargar información descriptiva -->
                                        <div *ngIf="!edu.get('grupo3Cargado') && !isLoading" class="text-center my-3">
                                            <button mat-button color="primary" (click)="cargarCamposAdicionales(i, 3)">
                                                <i class="fas fa-info-circle"></i> Agregar información descriptiva
                                            </button>
                                        </div>
                                    </ng-container>

                                    <!-- Campos del Grupo 3 (Información descriptiva) -->
                                    <ng-container *ngIf="edu.get('grupo3Cargado')">
                                        <div class="form-field">
                                            <label class="field-label" for="temaTesis">Tema de Tesis</label>
                                            <mat-form-field appearance="outline">
                                                <mat-label>Tema de Tesis</mat-label>
                                                <input matInput
                                                    formControlName="temaTesis"
                                                    placeholder="Si aplica, indique el tema de tesis">
                                            </mat-form-field>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-field-container">
                                                <label for="tipoActividad" class="form-label">Tipo de Actividad</label>
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Tipo de Actividad</mat-label>
                                                    <mat-select formControlName="tipoActividad">
                                                        <mat-option *ngFor="let tipo of tiposActividadCientifica" [value]="tipo.value">
                                                            {{tipo.label}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </div>

                                            <div class="form-field-container">
                                                <label for="caracter" class="form-label">Carácter</label>
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Carácter</mat-label>
                                                    <mat-select formControlName="caracter">
                                                        <mat-option *ngFor="let car of caracteresActividadCientifica" [value]="car.value">
                                                            {{car.label}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </div>
                                        </div>

                                        <div class="form-field">
                                            <label class="field-label" for="lugarFechaExposicion">Lugar y fecha de exposición</label>
                                            <mat-form-field appearance="outline">
                                                <mat-label>Lugar y fecha de exposición</mat-label>
                                                <input matInput
                                                    formControlName="lugarFechaExposicion"
                                                    placeholder="Si aplica, indique lugar y fecha">
                                            </mat-form-field>
                                        </div>

                                        <div class="form-field">
                                            <label class="field-label" for="comentarios">Comentarios</label>
                                            <mat-form-field appearance="outline">
                                                <mat-label>Comentarios</mat-label>
                                                <textarea matInput
                                                    formControlName="comentarios"
                                                    placeholder="Comentarios adicionales"
                                                    rows="3"></textarea>
                                            </mat-form-field>
                                        </div>

                                        <div class="form-field">
                                            <label class="field-label" for="descripcion">Descripción</label>
                                            <mat-form-field appearance="outline">
                                                <mat-label>Descripción</mat-label>
                                                <textarea matInput
                                                    formControlName="descripcion"
                                                    placeholder="Descripción detallada"
                                                    rows="3"></textarea>
                                            </mat-form-field>
                                        </div>
                                    </ng-container>

                                    <!-- Certificado de Educación -->
                                    <div class="form-field certificado-field">
                                        <label class="certificado-label">Certificado o Título (PDF)</label>
                                        <div class="certificado-container">
                                            <ng-container *ngIf="edu.get('certificadoId')?.value; else noCertificadoEdu">
                                                <div class="certificado-preview">
                                                    <span class="certificado-nombre">Certificado cargado</span>
                                                    <div class="certificado-actions">
                                                        <button mat-icon-button color="primary" type="button"
                                                                matTooltip="Ver certificado"
                                                                (click)="verCertificadoEducacion(edu.get('certificadoId')?.value)">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <button mat-icon-button color="warn" type="button"
                                                                matTooltip="Eliminar certificado"
                                                                (click)="eliminarCertificadoEducacion(i)">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-template #noCertificadoEdu>
                                                <button mat-stroked-button color="primary" type="button"
                                                        (click)="cargarCertificadoEducacion(i)">
                                                    <i class="fas fa-upload"></i>
                                                    Subir certificado
                                                </button>
                                                <span class="certificado-hint">
                                                    Sube un certificado o título en formato PDF que acredite esta formación
                                                </span>
                                            </ng-template>
                                        </div>
                                    </div>
                                </div>

                                <div class="item-actions">
                                    <button mat-icon-button
                                        type="button"
                                        class="delete-button"
                                        (click)="eliminarEducacion(i)"
                                        [attr.aria-label]="'Eliminar educación'">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>
                </main>
            </div>
        </mat-tab>

        <!-- Nueva Tab Documentación -->
        <mat-tab label="Documentación">
            <div class="tab-content">
                <app-documentacion-tab></app-documentacion-tab>
            </div>
        </mat-tab>

        <!-- Tab LinkedIn (si existe) -->
        <mat-tab label="LinkedIn" *ngIf="linkedInTab">
            <div class="tab-content">
                <div class="social-card">
                    <div class="social-header">
                        <i class="fab fa-linkedin"></i>
                        <h3>LinkedIn</h3>
                    </div>
                    <p>Conecta tu cuenta de LinkedIn para compartir tus logros y actividades</p>
                    <button mat-raised-button [color]="linkedInConectado ? 'warn' : 'primary'"
                        (click)="conectarLinkedIn()">
                        {{ linkedInConectado ? 'Desconectar' : 'Conectar' }}
                    </button>
                </div>
            </div>
        </mat-tab>
    </mat-tab-group>
</div>
